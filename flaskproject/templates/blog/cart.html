{% extends 'layout/base.html' %} {% block title %}Giỏ hàng - CleanCode{% endblock %} {%
block head_js %} {{ super() }}

<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/gioHang.css') }}"
/>
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/cart.css') }}"
/>

{% endblock %} {% block content %}
<div class="cart-page-container">
  {% if 'cart' in session and session['cart'] %}

  <div class="cart-items-list">
    <h2>Giỏ hàng của bạn ({{ stats.total_quantity }})</h2>

    <div class="cart-header">
      <div class="header-product">Sản phẩm</div>
      <div class="header-quantity">Số lượng</div>
      <div class="header-price">Đơn giá</div>
      <div class="header-total">Thành tiền</div>
      <div class="header-remove"></div>
    </div>

    {% for c in session['cart'].values() %}
    <div class="cart-item">
      <div class="item-product">
        <img
          src="{{ c.img | default(url_for('static', filename='img/default.png')) }}"
          alt="{{ c.name }}"
        />
        <div class="product-details">
          <h4>{{ c.name }}</h4>
          <p>Mã SP: {{ c.id }}</p>
        </div>
      </div>

      <div class="item-quantity">
        <span>{{ c.quantity }}</span>
      </div>

      <div class="item-price">{{ "{:,.0f}".format(c.price|float) }} ₫</div>

      <div class="item-total">
        <strong> {{ "{:,.0f}".format(c.price|float * c.quantity|int) }} ₫ </strong>
      </div>

      <div class="item-remove">
        <button class_="remove-btn" onclick="remove_item({{ c.id }})">
          &times;
        </button>
      </div>
    </div>
    {% endfor %}
  </div>

  <div class="order-summary-container">
    <h3>Tóm tắt đơn hàng</h3>
    <div class="summary-card">
      <div class="summary-row">
        <span>Tổng sản phẩm:</span>
        <span>{{ stats.total_quantity }}</span>
      </div>

      <div class="summary-row total-row">
        <span>Tổng tiền:</span>
        <strong class="total-amount">
          {{ "{:,.0f}".format(stats.total_amount) }} ₫
        </strong>
      </div>

      {% if current_user.is_authenticated %}
      <a href="{{ url_for('main.methods_pay') }}">
        <button type="button" class="container-pay">
          <div class="left-side">
            <div class="card-pay">
              <div class="card-line"></div>
              <div class="buttons-pay"></div>
            </div>
            <div class="post">
              <div class="post-line"></div>
              <div class="screen">
                <div class="dollar">$</div>
              </div>
              <div class="numbers"></div>
              <div class="numbers-line2"></div>
            </div>
          </div>
          <div class="right-side">
            <div class="new">Pay</div>
          </div>
        </button>
      </a>
      {% else %}
      <a
        href="{{ url_for('main.user_login', next='main.cart') }}"
        class="login-btn"
      >
        Đăng nhập để thanh toán
      </a>
      {% endif %}
    </div>
  </div>

  {% else %}
  <section class="cart-empty-section">
    <div class="cart-empty">
      <i class="iconcart-empty"></i>
      <h1>Giỏ hàng trống</h1>
      <span class="dmx">Không có sản phẩm nào trong giỏ hàng</span>
      <a href="{{ url_for('main.home') }}" class="btn-backhome">
        Về trang chủ
      </a>
    </div>
  </section>
  {% endif %}
</div>
{% endblock %} {% block footer %} {% endblock %} {% block body_js %} {{ super()
}}
<script src="{{ url_for('static', filename='js/gioHang.js') }}"></script>
<script src="{{ url_for('static', filename='js/cart.js') }}"></script>
{% endblock %}
